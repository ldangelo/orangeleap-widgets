<?xml version="1.0" encoding="UTF-8"?>
<project name="orangeleap-donatenow" basedir="..">
	<import file="donatenow-build.xml"/>
	<property file="${basedir}/build/build.properties" />
	<property file="${commonBuild.dir}/commonBuild.properties"/>
	<property name="build.env" value="dev"/>

	<target name="1. Deploy Exploded War" description="Deploys the exploded war.">
		<antcall target="deploy-exploded-war" />
	</target>

	<target name="2. Deploy War" description="Deploys the unexploded war.">
		<antcall target="deploy-integrated-war" />
	</target>

	<target name="3. Undeploy War" description="Undeploys war file(s).">
		<antcall target="undeploy-war" />
	</target>

	<target name="xjsp.sync" description="Sync jsp files">
	  <antcall target="jsp.synch"/>
	</target>

	<target name="xapp.sync" description="Sync files">
	  <antcall target="xapp.sync"/>
	</target>


	<target name="3.5. Start Tomcat - Non-Debug Mode">
	    <java jar="${appserver.home}/bin/bootstrap.jar" fork="true">
	        <jvmarg value="-Dcatalina.home=${appserver.home}"/>
	    	<jvmarg value="-Xms128M" />
	    	<jvmarg value="-Xmx512m" />
	    	<jvmarg value="-XX:MaxPermSize=512M" />
	    </java>
	</target>

	<target name="4. Start Tomcat - Debug Mode">
	  <echo>Setting up for environment = ${appserver.home}</echo>
	    <java jar="${appserver.home}/bin/bootstrap.jar" fork="true">
            <jvmarg value="-Xshare:off"/>
	        <jvmarg value="-Dcatalina.home=${appserver.home}"/>
	        <jvmarg value="-Xdebug"/>
	        <jvmarg value="-Xrunjdwp:transport=dt_socket,address=8000,server=y,suspend=n"/>
	    	<jvmarg value="-Xms128M" />
	    	<jvmarg value="-Xmx512m" />
	    	<jvmarg value="-XX:MaxPermSize=512M" />
	    </java>
	</target>

	<target name="5. Stop Tomcat">
	    <java jar="${appserver.home}/bin/bootstrap.jar" fork="true">
	        <jvmarg value="-Dcatalina.home=${appserver.home}"/>
	        <arg value="stop"/>
	    </java>
	</target>

	<target name="Load Schema" depends="resolve">
	     <sql driver="${mysql.db.driver}"
		          url="${mysql.db.url}"
		          userid="${mysql.db.user}"
		          password="${mysql.db.pw}"
		          encoding="UTF-8"
		          classpath="${compile.lib}"
 	              delimiter=";">
		    <transaction src="${basedir}/db/donatenow.sql"/>
	    </sql>

		<sql driver="${mysql.db.driver}"
		          url="${mysql.db.url}"
		          userid="${mysql.db.user}"
		          password="${mysql.db.pw}"
		          encoding="UTF-8"
		          classpath="${compile.lib}"
		     	  delimiter="$$">
		    <transaction src="${basedir}/db/prod/tangerine-functions.sql"/>
		</sql>
	</target>

</project>